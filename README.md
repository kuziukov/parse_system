# parse_system


##### Конфигурация файла .env

```
DEBUG=True
RABBIT_URI=amqp://user:pass@rabbit_mq:5672/
```

##### Команды управления проектом описаны в Makefile
###### Основные из них

```
make install - установить зависимости
make run - запустить приложение (local)
make check - проверка кода
make test - запуск тестов

make docker-image - сборка проекта
make docker-run - запуск проекта в контейнерах
```

##### Дополнительные улучшения

###### Введение
```
Общее улучшение - перевести приложение на асинхронное выполнение. (как мне видится без прокси серверов профита не будет)
Если нужна производительность - лучше выполнять таски пачками по N штук (в данных условиях это не даст приемущества)

Схема через Celery была реализована для упрощения. Из-за отсутствия прокси серверов и наличия защиты на сайте,
выгрузка 30000 ссылок сложной задачей за разумное время. Либо ждать таймауты, либо использовать прокси сервера.
Текущая архитектура была реализована чтобы попытаться невелировать отсутствие прокси серверов.

```

###### Клиент (Http)
```
Внедрить прокси сервера и их смену на лету
Расширить функционал do_refresh_profile (смена useragent, proxy сервера итд.)
Реализация функционала ограничения запросов (ThrottlingManager)
Запросы и загрузку файлов делать асинхронным способом с помощью (httpx)
```

###### БД (Postgres)

```
Данная схема реалищации была сделана для упрощения, необходимо реализовать базу данных, в которую бы публиковались
задачи на выполение, а в очередь отправляласись только <id> задачи.

Примерная схема:
Таблица :

id      <PRIMARY KEY>
url     <varchar>       - ссылка
status  <int4>          - статус выполения [0, 1, 2, 3]
message <varchar>       - описание произошедшей ошибки
updated <timestamp>     - изменяется после выполнения задачи
created <timestamp>     - создается в момент создания задачи

Статус выполнения:

0 - создано
1 - на выполнении
2 - выполнено
3 - ошибка
```

###### Тесты

```
Реализовать интеграционные тесты, которые бы включали в себя очередь и базу данных
Включить в тесты парсинг страниц на реальных html данных
```
